name: Auto Generate Contracts

on:
  schedule:
    # –ó–∞–ø—É—Å–∫–∞–µ–º –∫–∞–∂–¥—ã–µ 4 —á–∞—Å–∞ –≤ —Ä–∞–±–æ—á–∏–µ –¥–Ω–∏ (–ø–Ω-–ø—Ç)
    - cron: '0 */4 * * 1-5'
  
  # –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é
  workflow_dispatch:

jobs:
  generate-code:
    runs-on: ubuntu-latest
    
    permissions:
      contents: write
    
    steps:
    # –°–∫–∞—á–∏–≤–∞–µ–º –∫–æ–¥ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
    - name: Checkout code
      uses: actions/checkout@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
    
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Python
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–∞—à —Å–∫—Ä–∏–ø—Ç
    - name: Generate contract
      run: |
        python scripts/code_generator.py
    
    # –ö–æ–º–º–∏—Ç–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
    - name: Commit changes
      run: |
        git config --local user.email "bot@github.com"
        git config --local user.name "Contract Generator Bot"
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
        git add .
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
        if [ -n "$(git status --porcelain)" ]; then
          git commit -m "ü§ñ Auto-generated contract $(date '+%Y-%m-%d %H:%M')"
          git push
        else
          echo "No changes to commit"
        fi
